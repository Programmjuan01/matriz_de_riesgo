<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1" id="vp">
  <title>Matriz de Riesgos</title>

  <!-- Bootstrap 5 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Tu hoja de estilos personalizada -->
  <link rel="stylesheet" href="style.css">
</head>

<body class="bg-light">
<div class="container-fluid py-4">

  <h1 class="mb-4 neon">üìä Matriz de Riesgos</h1>

  <!-- ========== Formulario ========== -->
  <div class="card mb-4 shadow-sm">
    <div class="card-body">
      <!-- üîó JS captura el submit; no se env√≠a al servidor -->
      <form id="form-riesgo" class="row g-3">

        <div class="col-md-2">
          <label class="form-label">ID‚ÄØRiesgo</label>
          <input name="id_riesgo" class="form-control" required>
        </div>

        <div class="col-md-3">
          <label class="form-label">Macroproyecto</label>
          <input name="macroproy" class="form-control">
        </div>

        <div class="col-md-7">
          <label class="form-label">Descripci√≥n</label>
          <input name="descripcion" class="form-control">
        </div>

        <div class="col-md-3">
          <label class="form-label">Tipo de‚ÄØProyecto</label>
          <select name="tipo_pry" class="form-select">
            <option>NUEVO PROYECTO</option>
            <option>ARRASTRE DE PROYECTO</option>
            <option>ADELANTO</option>
          </select>
        </div>

        <div class="col-md-3">
          <label class="form-label">Grupo‚ÄØCAPEX</label>
          <select name="grupo_capex" class="form-select">
            <option>BASE</option>
            <option>INERCIAL</option>
            <option>INCREMENTAL</option>
          </select>
        </div>

        <div class="col-md-3">
          <label class="form-label">Probabilidad¬†(Pre)</label>
          <select name="prob_in" class="form-select">
            <option>Raro/Incierto</option>
            <option>Poco probable</option>
            <option>Medianamente</option>
            <option>Probable</option>
            <option>Casi certeza</option>
          </select>
        </div>

        <div class="col-md-3">
          <label class="form-label">Impacto¬†(Pre)</label>
          <select name="imp_in" class="form-select">
            <option>Muy Bajo</option>
            <option>Bajo</option>
            <option>Medio</option>
            <option>Alto</option>
            <option>Muy Alto</option>
          </select>
        </div>

        <div class="col-md-3">
          <label class="form-label">Probabilidad¬†(Post)</label>
          <select name="prob_post" class="form-select">
            <option>Raro/Incierto</option>
            <option>Poco probable</option>
            <option>Medianamente</option>
            <option>Probable</option>
            <option>Casi certeza</option>
          </select>
        </div>

        <div class="col-md-3">
          <label class="form-label">Impacto¬†(Post)</label>
          <select name="imp_post" class="form-select">
            <option>Muy Bajo</option>
            <option>Bajo</option>
            <option>Medio</option>
            <option>Alto</option>
            <option>Muy Alto</option>
          </select>
        </div>

        <div class="col-12 text-end">
          <button class="btn btn-primary">Guardar riesgo</button>
        </div>
      </form>
    </div>
  </div>

  <!-- ========== Tabla ========== -->
  <div class="card shadow-sm">
    <div class="card-body table-responsive">
      <table class="table table-dark table-hover table-bordered table-striped table-sm align-middle">
        <thead class="sticky-top">
          <tr>
            <th>ID‚ÄØRiesgo</th><th>Macroproyecto</th><th>Descripci√≥n</th>
            <th>Tipo‚ÄØProyecto</th><th>Grupo‚ÄØCAPEX</th>
            <th>Probabilidad</th><th>Impacto</th><th>Riesgo</th>
            <th>Probabilidad‚ÄØPost</th><th>Impacto‚ÄØPost</th><th>Riesgo‚ÄØResidual</th>
            <th>Acciones</th>
          </tr>
        </thead>
        <!-- üîó JS inyectar√° las filas aqu√≠ -->
        <tbody id="tabla-body"></tbody>
      </table>
    </div>
  </div>

  <!-- ========== Botones descarga / limpiar ========== -->
  <div class="mt-3 d-flex gap-2">
    <button type="button" id="btn-clear" class="btn btn-outline-danger">üóëÔ∏è¬†Limpiar matriz</button>
    <button type="button" id="dl-btn"   class="btn btn-success">‚¨áÔ∏è¬†Descargar Excel</button>
  </div>

</div>

<!-- Bootstrap bundle -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<!-- SheetJS + FileSaver para exportar Excel -->
<script src="https://cdn.jsdelivr.net/npm/xlsx@0.19.3/dist/xlsx.full.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/file-saver@2.0.5/dist/FileSaver.min.js"></script>
<!-- Tu l√≥gica -->
<script src="main.js" defer></script>
</body>
</html>